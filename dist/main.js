window.Forms=function(e){function t(t){for(var o,r,i=t[0],l=t[1],c=t[2],p=0,u=[];p<i.length;p++)r=i[p],s[r]&&u.push(s[r][0]),s[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(d&&d(t);u.length;)u.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,i=1;i<n.length;i++){var l=n[i];0!==s[l]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},s={0:0},a=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var i=window.webpackJsonpForms=window.webpackJsonpForms||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=l;return a.push([90,2]),n()}({0:function(e,t){e.exports=window.React},1:function(e,t){e.exports=window.antd},21:function(e,t){e.exports=window.ReactDOM},90:function(e,t,n){"use strict";n.r(t);var o=n(0),s=n.n(o),a=n(21),r=(n(22),n(1)),i=n(2);class l{static createField(e){let t={};return t.id=e.id,t.name=e.name,t.type=e.type,t.inputType=e.inputType,t.icon=e.icon,t.width=e.width,t.children=e.children,t.storage=e.storage,t.showLabel=Object(i.d)(e.showLabel,!0),t.showLegend=Object(i.d)(e.showLegend,!0),t.fieldOptions=new i.c(Object.assign({id:e.id},Object.assign({},e.fieldOptions))),t.condition=new i.b(e.id,e.condition),t.label=e.label,t.helpText=e.helpText,t.helpPlacement=e.helpPlacement,t.placeholder=e.placeholder,t.queryParam=e.queryParam,t.saveable=e.saveable,t.value=e.value,t}}class c{static createForm(e){let t={};t.id=e.id,t.exid=e.exid,t.desc=e.desc,t.name=e.name;let n=e.formLayoutOptions||{};t.formLayoutOptions={wrapperSpan:Object(i.d)(n.wrapperSpan,20),wrapperOffset:Object(i.d)(n.wrapperOffset,2),showPageBorders:Object(i.d)(n.showPageBorders,!0),showSectionBorders:Object(i.d)(n.showSectionBorders,!0),showPageTitles:Object(i.d)(n.showPageTitles,!0),showSectionTitles:Object(i.d)(n.showSectionTitles,!0),showSteps:Object(i.d)(n.showSteps,!0),validationDisablesPaging:Object(i.d)(n.validationDisablesPaging,!0)};let o={};e.tenant&&(o.context=e.tenant.content,o.stack=e.tenant.content,o.eid=e.tenant.content,o.mid=e.tenant.content),t.tenant=e.tenant;let s={};e.status&&(s.timezone=e.status.timezone,s.paused=e.status.paused,s.active=e.status.active,s.created=e.status.created,s.edited=e.status.edited,s.starts=e.status.starts,s.ends=e.status.ends),t.status=s;let a={};return a.title=e.content.title,a.subtitle=e.content.subtitle,a.labels=e.content.labels,a.offset=e.content.offset,a.width=e.content.width,a.sidebar=e.content.sidebar,a.scripts=e.content.scripts,a.styles=e.content.styles,a.datasets=e.content.datasets,a.paginate=e.content.paginate,a.css=e.content.css,a.header=e.content.header,a.footer=e.content.footer,a.trackingPixels=e.content.trackingPixels,a.pages=[],(e.content.pages||[]).forEach((e,t)=>{let n={name:e.name,icon:e.icon,sections:[],type:e.type,title:e.title,subtitle:e.subtitle,wizard:e.wizard};e.sections.forEach((e,t)=>{let o={id:e.id,name:e.name,gutter:e.gutter,columns:[]};e.columns.forEach((e,t)=>{let n=new i.a(e.id,e.name,e.title,[]);e.fields.map((e,t)=>{let o=l.createField(e);n.fields.push(o)}),o.columns.push(n)}),n.sections.push(o)}),a.pages.push(n)}),t.content=a,t}}class d extends o.Component{constructor(e){super(e),this.props=e,this.state={hidden:!e.conditionals[this.props.field.id].result}}render(){const{field:e,decorators:t,formLayout:n,eventHooks:s}=this.props,{type:a}=e;let i=t.getFieldDecorator,{onChange:l}=s(e.id);return this.props.conditionals[this.props.field.id].result&&o.createElement(r.Form.Item,Object.assign({label:e.label},n),("input"==a||"hidden"==a)&&i(e.id,e.fieldOptions)(o.createElement(r.Input,{onChange:l,type:e.inputType,placeholder:e.placeholder})),"checkbox"==a&&i(e.id,e.fieldOptions)(o.createElement(r.Checkbox,{onChange:l})),"number"==a&&i(e.id,e.fieldOptions)(o.createElement(r.InputNumber,{onChange:l})),"select"==a&&i(e.id,e.fieldOptions)(o.createElement(r.Select,{onChange:l},e.children.map((e,t)=>o.createElement(r.Select.Option,{key:""+t,value:e.value},e.label)))),"radiogroup"==a&&i(e.id,e.fieldOptions)(o.createElement(r.Radio.Group,{onChange:l,options:e.children})),"checkboxgroup"==a&&i(e.id,e.fieldOptions)(o.createElement(r.Checkbox.Group,{onChange:l,options:e.children})),"textarea"==a&&i(e.id,e.fieldOptions)(o.createElement(r.Input.TextArea,{onChange:l})),"datepicker"==a&&i(e.id,e.fieldOptions)(o.createElement(r.DatePicker,{onChange:l})),"monthpicker"==a&&i(e.id,e.fieldOptions)(o.createElement(r.DatePicker.MonthPicker,{onChange:l})),"rangepicker"==a&&i(e.id,e.fieldOptions)(o.createElement(r.DatePicker.RangePicker,{onChange:l})),"weekpicker"==a&&i(e.id,e.fieldOptions)(o.createElement(r.DatePicker.WeekPicker,{onChange:l})),"rate"==a&&i(e.id,e.fieldOptions)(o.createElement(r.Rate,{onChange:l})),"slider"==a&&i(e.id,e.fieldOptions)(o.createElement(r.Slider,{onChange:l})),"textblock"==a&&o.createElement("p",null,e.value))}}class p extends o.Component{constructor(e){super(e),this.props=e}render(){let{column:e,formLayout:t,span:n,conditionals:s,decorators:a,eventHooks:i}=this.props;return o.createElement(r.Col,{span:n},e.fields.map((e,n)=>o.createElement(d,{field:e,key:n,formLayout:t,conditionals:s,decorators:a,eventHooks:i})))}}class u extends o.Component{constructor(e){super(e),this.props=e}render(){let{section:e,formLayout:t,conditionals:n,decorators:s,eventHooks:a}=this.props,{showSectionTitles:i,showSectionBorders:l}=t;const c=e.columns.length;return o.createElement(r.Card,{bordered:l,title:i?e.name:""},o.createElement(r.Row,{gutter:16},e.columns.map((e,r)=>o.createElement(p,{formLayout:t,key:r,column:e,span:24/c,conditionals:n,decorators:s,eventHooks:a}))))}}class m extends o.Component{constructor(e){super(e),this.props=e}render(){let{page:e,formLayout:t,index:n,eventHooks:s,decorators:a,conditionals:i}=this.props;return o.createElement("div",{className:"page-content"},o.createElement(r.Card,{title:t.showPageTitles?e.title:""},o.createElement("div",{className:"page",key:n.toString()},e.sections.map((e,n)=>o.createElement(u,{section:e,key:n,conditionals:i,formLayout:t,decorators:a,eventHooks:s})))))}}class h{static registerFieldConditions(e,t,n,o){return t=Object.assign({},t,{dependencies:{},conditionals:{},ancestors:{}}),e.forEach(e=>{e.condition&&(n[`${e.id}`]=e.condition,t.conditionals[`${e.id}`]={result:e.condition.value(o.getFieldValue)},e.condition.ancestors&&(t.ancestors[e.id]=e.condition.ancestors))}),Object.keys(t.ancestors).forEach(e=>{t.ancestors[e].forEach(n=>{t.dependencies[n]=t.dependencies[n]?t.dependencies[n]:[],t.dependencies[n].push(e)})}),t}static deregisterFieldConditions(e,t,n){let{dependencies:o,conditionals:s,ancestors:a}=t;return e.forEach(e=>{n[`${e.id}`]&&(delete n[`${e.id}`],delete s[`${e.id}`]),e.condition.ancestors&&delete a[e.id],Object.keys(o).forEach(t=>{o[t].indexOf(e.id)>-1&&(o[t]=Array.prototype.filter(t=>{e.id}))})}),{dependencies:o,conditionals:s,ancestors:a}}}var f=r.Form.create()(class extends o.Component{constructor(e){super(e),this.evaluators={},this.handleConfirmBlur=(e=>{console.log("handleConfirmBlue");const t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})}),this.handleSubmit=(e=>{console.log("handleSubmit"),e.preventDefault();let t=this;this.props.form.validateFields((e,n)=>{if(e){let{locations:n}=t.state.fieldMeta,o=Object.keys(e).map(e=>n[e].page).reduce((e,t)=>t?e<t?e:t:e);setTimeout(()=>{t.setState({currentPage:o})})}else{let e=Object.assign({payload:n},{props:t.state.innerProps});console.log("Received values of form: ",e)}})}),this.eventHooks=(e=>({onChange:this.onChange.bind(this,e),onBlur:this.handleConfirmBlur.bind(this)}));let{formData:t}=e,n={currentPage:(t.content&&t.content.pages.length,0),numPages:t.content&&t.content.pages.length>0?t.content.pages.length:0,confirmDirty:!1,fieldMeta:{locations:{},allFields:[],pageFields:{}}};t.content.pages.forEach((e,t)=>{e.sections.forEach((e,o)=>{e.columns.forEach((e,s)=>{e.fields.forEach((e,a)=>{n.fieldMeta.allFields.push(e),e.location=e.location={page:t,section:o,column:s,field:a},n.fieldMeta.locations[e.id]={page:t,section:o,column:s,field:a},n.fieldMeta.pageFields[t]=n.fieldMeta.pageFields[t]?n.fieldMeta.pageFields[t]:{names:[],ids:[]},n.fieldMeta.pageFields[t].names.push(e.name)})})})}),this.state=h.registerFieldConditions(n.fieldMeta.allFields,n,this.evaluators,this.props.form)}componentDidMount(){console.log("Form Mounted")}next(){console.log("nextPage");let e=this;const t=this.state.currentPage;this.props.formData.formLayoutOptions.validationDisablesPaging?this.props.form.validateFields(this.state.fieldMeta.pageFields[t].names,n=>{n||e.setState({currentPage:t+1})}):this.setState({currentPage:t+1})}prev(){console.log("prevPage");const e=this.state.currentPage-1;this.setState({currentPage:e})}onChange(e){let t=this;console.log("onChange",e),setTimeout(()=>{(t.state.dependencies[e]||[]).forEach(e=>{let n=Object.assign({},t.state);n.conditionals[e].result=t.evaluators[e].value(t.props.form.getFieldValue),t.setState(n)})},0)}render(){let{formData:e}=this.props;return o.createElement("div",{className:"form-wrapper"},e.content.title&&o.createElement(r.Card,null,o.createElement("h2",null,e.content.title),o.createElement("br",null),o.createElement("h3",null,e.content.subtitle)),e.formLayoutOptions.showSteps&&o.createElement(r.Row,null,o.createElement(r.Col,{span:24},o.createElement(r.Card,null,o.createElement(r.Steps,{size:"small",current:this.state.currentPage},e.content.pages.map((e,t)=>o.createElement(r.Steps.Step,{title:e.title,key:t})))))),o.createElement(r.Row,null,o.createElement(r.Col,{span:24},o.createElement(r.Form,{onSubmit:this.handleSubmit,layout:this.props.layout},e.content.pages.map((e,t)=>{let{currentPage:n}=this.state,{formLayoutOptions:s}=this.props.formData;return o.createElement("div",{className:"page-wrapper",key:t,style:{visibility:n==t?"visible":"hidden",display:n==t?"block":"none"}},o.createElement(m,{page:e,conditionals:this.state.conditionals,index:t,formLayout:s,decorators:this.props.form,eventHooks:this.eventHooks}))}),o.createElement("div",{className:"page-actions"},o.createElement(r.Card,null,o.createElement(r.Row,null,o.createElement(r.Col,{span:24,style:{textAlign:"right"}},o.createElement(r.Form.Item,null,o.createElement(r.Button,{disabled:(t=this.props.form.getFieldsError(),Object.keys(t).some(e=>t[e])),type:"primary",style:{marginLeft:8},htmlType:"submit",className:"action-button"},"Submit"),this.state.currentPage<this.state.numPages-1&&o.createElement(r.Button,{type:"primary",style:{marginLeft:8},className:"action-button",onClick:()=>this.next()},"Next"),this.state.currentPage>0&&this.state.numPages>1&&o.createElement(r.Button,{type:"primary",className:"action-button",onClick:()=>this.prev()},"Prev"))))))))));var t}});class g extends o.Component{constructor(e){super(e),this.state={formData:c.createForm(this.props.formData)}}render(){const{formData:e}=this.state;return o.createElement(r.Layout,{style:{height:"100vh"}},o.createElement(r.Row,null,o.createElement("br",null)),o.createElement(r.Row,{justify:"space-around"},o.createElement(r.Col,{span:e.formLayoutOptions.wrapperSpan,offset:e.formLayoutOptions.wrapperOffset},o.createElement(f,{formData:e}))),o.createElement(r.Row,null))}}function b(e,t){Object(a.render)(s.a.createElement(g,{formData:t}),document.querySelector(e))}n.d(t,"renderForm",function(){return b})}});
//# sourceMappingURL=main.js.map